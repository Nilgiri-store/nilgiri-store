<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Register - Nilgiri Local Store</title>
<style>
body{font-family:Arial,sans-serif;margin:0;padding:0;background:#f5f7fb;display:flex;justify-content:center;align-items:center;height:100vh}
.container{background:#fff;padding:24px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.1);width:320px}
h2{text-align:center;color:#0ea5e9}
input{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #ccc}
button{width:100%;padding:10px;background:#0ea5e9;color:#fff;border:none;border-radius:6px;cursor:pointer}
</style>
</head>
<body>
<div class="container">
<h2>Register</h2>
<input type="text" id="name" placeholder="पूरा नाम" required>
<input type="text" id="mobile" placeholder="मोबाइल नंबर" required>
<input type="text" id="block" placeholder="Block" required>
<input type="text" id="flat" placeholder="Flat No." required>
<button id="btnRegister">Register</button>
<p id="msg" style="color:red;text-align:center;"></p>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyBRTrBG-AsNvUMmBb2vMePNvAspZfi3zOs",
authDomain: "nilgiri-store.firebaseapp.com",
projectId: "nilgiri-store",
storageBucket: "nilgiri-store.firebasestorage.app",
messagingSenderId: "556171236549",
appId: "1:556171236549:web:5df5741c44ea8d9bfc8cac"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const K_USER = 'np_user';

const save = (k,v)=>localStorage.setItem(k,JSON.stringify(v));

document.getElementById('btnRegister').onclick = async ()=>{
  const name = document.getElementById('name').value.trim();
  const mobile = document.getElementById('mobile').value.trim();
  const block = document.getElementById('block').value.trim();
  const flat = document.getElementById('flat').value.trim();
  const msg = document.getElementById('msg');
  if(!name || !mobile || !block || !flat){ msg.innerText="सभी फ़ील्ड भरें"; return; }
  const userData = { name, mobile, block, flat, createdAt: new Date().toISOString() };
  try{
    await addDoc(collection(db,'users'),userData);
    save(K_USER,userData);
    window.location.href='index.html';
  }catch(e){ console.error(e); msg.innerText="Registration failed";}
};
</script>
</body>
</html>